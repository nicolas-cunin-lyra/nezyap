apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  name: {{ include "nezyap.fullname" . }}-catalog-backend
  namespace: {{ include "nezyap.name" . }}
  labels:
    {{- include "nezyap.labels" . | nindent 4 }}
    app.kubernetes.io/element: catalog-backend
spec:
  triggers:
  - type: GitHub
    github:
      secretReference:
        name: {{ include "nezyap.fullname" . }}-nicolas-cunin-lyra-github-secret
  source:
      type: "Git"
      git:
        uri: {{ .Values.source.repository }}
        ref: {{ .Values.source.branch }}
      contextDir: catalog-backend
  strategy:
    type: Source
    sourceStrategy:
        from:
          kind: ImageStreamTag
          namespace: openshift
          name: nodejs:14-ubi8
        incremental: true
  output:
    to:
      kind: ImageStreamTag
      name: {{ include "nezyap.fullname" . }}-catalog-backend:{{ .Values.image.version }}
      namespace: {{ include "nezyap.name" . }}
